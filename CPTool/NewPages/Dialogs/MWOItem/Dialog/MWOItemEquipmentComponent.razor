@using CPTool.Application.Features.ChapterFeatures.CreateEdit
@using CPTool.Application.Features.EquipmentTypeSubFeatures.Query.GetById

@if (assign)
{
    <MudGrid>
        <MudItem xs="12" sm="6">
            <AutoCompleteComponent T="EditEquipmentType"
                               TAdd="AddEquipmentType"
                               TGedById="GetByIdEquipmentTypeQuery"
                               TList="GetEquipmentTypeListQuery"
                               TableName="Equipment Type"
                               Label="Equipment Type"
                               SelectionChanged="@((arg)=>{Model.EquipmentType=arg;})"
                               ValidateForm="DialogParent.Validateform"
                               @bind-Elements="@GlobalTables.EquipmentTypes"
                               Model=@Model.EquipmentType
                               ShowDialogOverrided="ToolDialogService.ShowEquipmentType"
                               Validation="@(new Func<string, string>(ValidateEquipmentType))"></AutoCompleteComponent>
            <AutoCompleteComponent T="EditEquipmentTypeSub"
                               TAdd="AddEquipmentTypeSub"
                               TGedById="GetByIdEquipmentTypeSubQuery"
                               TList="GetEquipmentTypeSubListQuery"
                               TableName="Sub Equipment Type"
                               Label="Sub Equipment Type"
                               Parent=@Model.EquipmentType
                               SelectionChanged="@((arg)=>{Model.EquipmentTypeSub=arg;})"
                               Model=@Model.EquipmentTypeSub
                               ValidateForm="DialogParent.Validateform"
                               UpdateMasterParent=UpdateEquipmentType
                               Disable=@(Model.EquipmentType.Id==0?true:false)
                               Elements="@(Model.EquipmentType.EquipmentTypeSubs)"
                               ShowDialogOverrided="ToolDialogService.ShowEquipmentTypeSub"
                               Validation="@(new Func<string, string>(ValidateEquipmentSubType))"></AutoCompleteComponent>


            <MudTextField T="string" @bind-Value="Model.TagNumber"
                      Required="true"
                      Immediate="true"
                      Label="Tag Number"
                      Margin="Margin.Dense"
                      Variant="Variant.Outlined"
                      RequiredError="Must have Tag Number"></MudTextField>

            <MudTextField T="string" Value="@Model.TagId"
                      Immediate="true"
                      Disabled="true"
                      Margin="Margin.Dense"
                      Variant="Variant.Outlined"
                      Label="Tag"></MudTextField>


        </MudItem>
        <MudItem xs="12" sm="6">
            <SelectComponent T="EditBrand"
                         Elements=@GlobalTables.Brands
                         Label="Brand or Service"
                         SelectionChanged="BrandChanged"
                         @bind-Value="@Model.Brand">


            </SelectComponent>
            <SelectComponent T="EditSupplier"
                         Elements=@Model.Brand.BrandSuppliers.Select(x=>x.Supplier).ToList()
                         Label="Supplier"
                         Disable=@(Model.Brand.Id==0?true:false)
                         @bind-Value="@Model.Supplier">


            </SelectComponent>



            <MudTextField T="string" @bind-Value="Model.Model"
                      Immediate="true"
                      Label="Model"
                      Margin="Margin.Dense"
                      Variant="Variant.Outlined"></MudTextField>
            <MudTextField T="string" @bind-Value="Model.Reference"
                      Immediate="true"
                      Label="Reference"
                      Margin="Margin.Dense"
                      Variant="Variant.Outlined"></MudTextField>
            <MudTextField T="string" @bind-Value="Model.SerialNumber"
                      Immediate="true"
                      Label="Serial Number"
                      Margin="Margin.Dense"
                      Variant="Variant.Outlined"></MudTextField>

        </MudItem>
    </MudGrid>
}


@code {
    bool assign = true;

}
